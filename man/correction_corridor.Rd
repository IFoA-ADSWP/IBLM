% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{correction_corridor}
\alias{correction_corridor}
\title{Create Correction Corridor Visualization}
\usage{
correction_corridor(
  ensemble,
  explainer,
  trim_vals = c(NA, 4, 1, 0.2, 0.15, 0.1, 0.05, 0),
  sample_perc = 0.2,
  var = NA
)
}
\arguments{
\item{ensemble}{An ensemble model object (typically of class "ens") containing
both GLM and XGBoost components, with a predict method}

\item{explainer}{An explainer object containing an input_frame element with
the data to be used for predictions}

\item{trim_vals}{Numeric vector of trim values to test. Default is
c(NA, 4, 1, 0.2, 0.15, 0.1, 0.05, 0). NA represents no trimming}

\item{sample_perc}{Numeric value between 0 and 1 specifying the fraction
of data to sample for visualization. Default is 0.2 (20%)}

\item{var}{Character string specifying an optional variable name from the
data to use for coloring points. Default is NA (no coloring variable)}
}
\value{
A ggplot2 object showing a faceted scatter plot with:
  \itemize{
    \item X-axis: GLM predictions
    \item Y-axis: Ensemble predictions
    \item Facets: Different trim values
    \item Reference line: y = x (perfect agreement line)
    \item Optional: Points colored by specified variable
  }
}
\description{
Generates a faceted scatter plot comparing GLM predictions against ensemble
predictions across different trim values. This visualization helps assess
how ensemble corrections vary with different trimming parameters and
identifies the "correction corridor" where the ensemble modifies GLM predictions.
}
\details{
The function works by:
\enumerate{
  \item Sampling a subset of data from the explainer's input_frame
  \item Computing GLM predictions once for efficiency
  \item Generating ensemble predictions for each trim value
  \item Creating a faceted visualization to compare prediction patterns
}

The "correction corridor" refers to the deviation patterns between GLM and
ensemble predictions. Points near the diagonal line (y = x) indicate minimal
correction, while points further from the line show where the ensemble
significantly adjusts GLM predictions.

Different trim values control the magnitude of ensemble corrections, and
this visualization helps identify optimal trimming parameters by showing
how corrections behave across the prediction range.
}
\examples{
\dontrun{
# Basic usage with default trim values
correction_corridor(my_ensemble, my_explainer)

# With custom trim values and coloring by a variable
correction_corridor(
  ensemble = my_ensemble,
  explainer = my_explainer,
  trim_vals = c(NA, 1, 0.5, 0.1),
  sample_perc = 0.3,
  var = "age_group"
)

# High-resolution plot with more data
correction_corridor(
  ensemble = my_ensemble,
  explainer = my_explainer,
  sample_perc = 0.5
)
}

}
