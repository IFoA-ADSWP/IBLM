[{"path":"https://ifoa-adswp.github.io/IBLM/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Karol Gawlowski Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"IBLM","text":"IBLM can installed CRAN GitHub:","code":"# From CRAN install.packages(\"IBLM\")  # From GitHub remotes::install_github(\"IFoA-ADSWP/IBLM\")"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"IBLM","text":"IBLM stands ‚ÄúInterpretable Boosted Linear Model‚Äù. IBLM essentially hybrid model consisting two components: Generalised Linear Model (GLM) - fitted training data Booster Model1 - fitted residuals training data GLM predictions step 1. purpose article show use IBLM train, explain predict using functions package.","code":"library(IBLM)"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"theory","dir":"Articles","previous_headings":"","what":"Theory","title":"IBLM","text":"overall process fitting interpreting IBLM follows: Step 1: Fit GLM g(Œº)=Œ≤0+Œ≤1x1+Œ≤2x2+‚ãØ+Œ≤nxn g(\\mu) = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\cdots + \\beta_n x_n g(¬∑) link function, Œº expected value response, Œ≤ values standard regression coefficients. GLM prediction=g‚àí1(Œ≤0+Œ≤1x1+Œ≤2x2+‚ãØ+Œ≤nxn) \\text{GLM prediction} = g^{-1} (\\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\cdots + \\beta_n x_n) Œ≤ values standard regression coefficients. Step 2: Train Booster GLM‚Äôs Errors Train booster model (.e.¬†XGBoost) residuals actual response values GLM predictions. Step 3: Use SHAP Break Booster SHAP decomposition allows booster‚Äôs prediction apportioned contributions feature: Booster prediction=g‚àí1(œÜ0+œÜ1(x)+œÜ2(x)+‚ãØ+œÜn(x)) \\text{Booster prediction} = g^{-1} (\\varphi_0 + \\varphi_1(x) + \\varphi_2(x) + \\cdots + \\varphi_n(x)) œÜj(x)\\varphi_j(x) much feature j contributed specific prediction. Step 4: Convert SHAP Values Beta Coefficient Corrections Transform SHAP contribution beta corrections: Œ±j(x)‚âàœÜj(x)xj \\alpha_j(x) \\approx \\frac{\\varphi_j(x)}{x_j} two situations value Œ±j(x)\\alpha_j(x) set zero value œÜj(x)\\varphi_j(x) added intercept instead. xx numerical variable, value zero. , xx categorical variable, value reference level2. Œ±j(x)=0 {xj=0(numerical)xj=ref(categorical)Œ±0(x)=‚àëj:xj=0or xj=refœÜj(x) \\begin{aligned} \\alpha_j(x) &= 0 \\text{ }  \\begin{cases} x_j = 0 & \\text{(numerical)} \\\\ x_j = \\text{ref} & \\text{(categorical)} \\end{cases} \\\\[1em] \\alpha_0(x) &= \\sum_{\\substack{j: x_j = 0 \\\\ \\text{} x_j = \\text{ref}}} \\varphi_j(x) \\end{aligned} Step 5: Combine final IBLM can interpreted collection adjusted GLMs. row data essentially GLM coefficients. addition : GLM coefficients derived step 1, rows beta corrections derived step 4, unique predictor variable combination. g(Œº)=(Œ≤0+œÜ0+Œ±0)+(Œ≤1+Œ±1(x))x1+(Œ≤2+Œ±2(x))x2+‚ãØ+(Œ≤n+Œ±n(x))xn g(\\mu) = (\\beta_0 + \\varphi_0 + \\alpha_0) + (\\beta_1 + \\alpha_1(x))x_1 + (\\beta_2 + \\alpha_2(x))x_2 + \\cdots + (\\beta_n + \\alpha_n(x))x_n g(Œº)=Œ≤‚Ä≤0+Œ≤‚Ä≤1x1+Œ≤‚Ä≤2x2+‚ãØ+Œ≤‚Ä≤nxnwhere Œ≤‚Ä≤j=Œ≤j+Œ±j(x)Œ≤‚Ä≤0=Œ≤0+œÜ0+Œ±0 \\begin{aligned} g(\\mu) &= \\beta'_0 + \\beta'_1 x_1 + \\beta'_2 x_2 + \\cdots + \\beta'_n x_n \\\\ \\text{} \\beta'_j &= \\beta_j + \\alpha_j(x) \\\\ \\text{} \\beta'_0 &= \\beta_0 + \\varphi_0 + \\alpha_0 \\end{aligned} g(¬∑) link function, Œº expected value response, Œ≤ values standard regression coefficients. IBLM prediction combination components. IBLM prediction=g‚àí1(Œ≤‚Ä≤0+Œ≤‚Ä≤1x1+Œ≤‚Ä≤2x2+‚ãØ+Œ≤‚Ä≤nxn)={GLM prediction√óBooster predictionwhen g=logGLM prediction+Booster predictionwhen g=identity \\begin{aligned} \\text{IBLM prediction} &= g^{-1} (\\beta'_0 + \\beta'_1 x_1 + \\beta'_2 x_2 + \\cdots + \\beta'_n x_n) \\\\[0.5em] &= \\begin{cases} \\text{GLM prediction} \\times \\text{Booster prediction} & \\text{} g = \\log \\\\ \\text{GLM prediction} + \\text{Booster prediction} & \\text{} g = \\text{identity} \\end{cases} \\end{aligned} preserves familiar GLM form incorporating booster‚Äôs superior predictive power.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"train","dir":"Articles","previous_headings":"","what":"Train","title":"IBLM","text":"train IBLM must get data appropriate format. document demonstrations completed using French motor claims dataset freMTPL2freq. Data training IBLM model must form list 3 dataframes. named ‚Äútrain‚Äù, ‚Äúvalidate‚Äù ‚Äútest‚Äù. function split_into_train_validate_test() can conveniently split single dataframe structure. currently one function available train IBLM. train_iblm_xgb() use xgboost booster model. performs steps 1 2 Theory. output class ‚Äúiblm‚Äù. Objects class contain two component models ‚Äúglm_model‚Äù ‚Äúbooster_model‚Äù. also items containing information (see Value section train_iblm_xgb() information) convenience, also possible train XGBoost model using settings used model class ‚Äúiblm‚Äù. can useful directly comparing (example see Pinball Score)","code":"df <- load_freMTPL2freq()  df <- df |> mutate(ClaimNb = round(ClaimNb))   df_list <- df |> split_into_train_validate_test(seed = 1) iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimNb\",   family = \"poisson\",   params = list(seed = 1) )  class(iblm_model) #> [1] \"iblm\" xgb_model <- train_xgb_as_per_iblm(iblm_model)  is_identical_config <- purrr::map2_lgl(   xgboost::xgb.config(xgb_model) |> unlist(),   xgboost::xgb.config(iblm_model$booster_model) |> unlist(),   identical )   # the config is mostly identical. In our example the differences are: is_identical_config[!is_identical_config] |> names() #> [1] \"learner.gradient_booster.gbtree_model_param.num_trees\" #> [2] \"learner.learner_model_param.base_score\""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"explain","dir":"Articles","previous_headings":"","what":"Explain","title":"IBLM","text":"Code explain interpret object class ‚Äúiblm‚Äù conveniently wrapped explain_iblm() function. performs steps 3, 4 5 Theory. values derived based data fed , usually test portion dataset. following line required: output object list containing following items: beta_corrected_scatter Function create scatter plots showing SHAP corrections vs variable values (see beta_corrected_scatter()) beta_corrected_density Function create density plots SHAP corrections variables (see beta_corrected_density()) bias_density Function create density plots SHAP corrections migrated bias (see bias_density()) overall_correction Function show global correction distributions (see overall_correction()) shap Dataframe showing raw SHAP values data records. œÜn(x)\\varphi_n(x) values described step 3 Theory. beta_corrections Dataframe showing beta corrections (wide/one-hot format) data records. Œ±0(x)\\alpha_0(x) Œ±j(x)\\alpha_j(x) values described step 4 Theory. data_beta_coeff Dataframe showing corrected beta coefficients data records. Œ≤‚Ä≤0\\beta'_0 Œ≤‚Ä≤j\\beta'_j values described step 5 Theory. categorical variables, value corresponds relevant coefficient datapoint. Many items output functions. functions can called observe components ‚Äúiblm‚Äù object different ways.","code":"ex <- explain_iblm(iblm_model, df_list$test)"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"beta-corrected-density","dir":"Articles","previous_headings":"Explain","what":"Beta Corrected Density","title":"IBLM","text":"corrected beta coefficients (Œ≤‚Äô‚±º) can observed density plot. plotting function allows user see corrected beta coefficient values particular variable. density plot also shows standard error original beta coefficient, fitted GLM model component. can useful understanding significance range corrected beta coefficients.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"numerical-variables","dir":"Articles","previous_headings":"Explain > Beta Corrected Density","what":"Numerical Variables","title":"IBLM","text":"numerical variables, calling function creates single plot. show examples different numerical variables freMTPL2freq dataset.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"section","dir":"Articles","previous_headings":"","what":"IBLM","title":"IBLM","text":"VehPower VehAge DrivAge BonusMalus","code":"ex$beta_corrected_density(varname = \"VehPower\") ex$beta_corrected_density(varname = \"VehAge\") ex$beta_corrected_density(varname = \"DrivAge\") ex$beta_corrected_density(varname = \"BonusMalus\")"},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"categorical-variables","dir":"Articles","previous_headings":"Explain","what":"Categorical Variables","title":"IBLM","text":"categorical variables, calling function creates list ggplot objects. separate plot produced level categorical variable. Note include reference level. example ‚ÄúVehBrand‚Äù 11 levels produces 10 plots. Level ‚ÄúB1‚Äù reference level beta coefficient within GLM component. Instead, ‚ÄúB1‚Äù, SHAP values migrated bias (see Bias Corrected Density). Also example, wrapped list using patchwork create single graphic simplicity.","code":"VehBrand <- ex$beta_corrected_density(varname = \"VehBrand\", type = \"hist\")  VehBrand |> patchwork::wrap_plots(ncol = 2)"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"beta-corrected-scatter","dir":"Articles","previous_headings":"Explain","what":"Beta Corrected Scatter","title":"IBLM","text":"corrected beta coefficients (Œ≤‚Äô‚±º) can observed scatter plot (boxplot). plotting function allows user see corrected beta coefficient values particular variable relationship particlar variable value.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"numerical-variables-1","dir":"Articles","previous_headings":"Explain > Beta Corrected Scatter","what":"Numerical Variables","title":"IBLM","text":"varname set numerical variable, scatter plot produced. example shows relationship corrected beta coefficient values driver age. Note original beta coefficient fitted GLM component shown dashed black line (stated near top plot orange). can see corrected beta coefficients can materially different. also smoothed trend line fitted shows overall pattern correction. Note color argument can also set try observe interactions second variable.","code":"ex$beta_corrected_scatter(varname = \"DrivAge\", color = \"VehPower\") #> `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"categorical-variables-1","dir":"Articles","previous_headings":"Explain > Beta Corrected Scatter","what":"Categorical Variables","title":"IBLM","text":"varname set categorical variable, boxplot produced. shows distribution individual level within categorical variable. Note color argument can also set try observe interactions second variable.","code":"ex$beta_corrected_scatter(varname = \"VehBrand\")"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"bias-corrected-density","dir":"Articles","previous_headings":"Explain","what":"Bias Corrected Density","title":"IBLM","text":"described step 4 Theory, shap values translated beta corrections. values instead migrated bias. two situations can occur: Numerical variable value zero data point. Categorical variable value reference level data point. bias_correction_var plot visualise individual times occured test dataset. categorical variables Area, Region, VehBrand VehGas total counts repsective facets histogram equal total occurences reference level variable. numerical variable VehAge total count facet equal total occurences zero VehAge dataset. numerical variables dropped plot instances zero value (example DrivAge) bias_correction_total plot cumulative sum components across data point. Note data point bias migration (.e.¬†conditions 1 2 occur) standard bias adjustment counted plot. standard bias value, along standard error around , can observed straight blue line dashed orange lines either side. bias values can observed bias_density().","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"section-2","dir":"Articles","previous_headings":"","what":"IBLM","title":"IBLM","text":"Variable Total","code":"bias_corrections <- ex$bias_density() bias_corrections$bias_correction_var bias_corrections <- ex$bias_density() bias_corrections$bias_correction_total"},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"overall-correction","dir":"Articles","previous_headings":"Explain","what":"Overall Correction","title":"IBLM","text":"distribution overall corrections across test data can observed. link function log correction multiplier (case ). link function identity, overall correction addition. default x scale transformed link function, can switched .","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"section-4","dir":"Articles","previous_headings":"","what":"IBLM","title":"IBLM","text":"Link Transformed transformed","code":"ex$overall_correction() ex$overall_correction(transform_x_scale_by_link = FALSE)"},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"predict","dir":"Articles","previous_headings":"","what":"Predict","title":"IBLM","text":"package contains predict method class ‚Äúiblm‚Äù. employs predict() method ‚Äúglm_model‚Äù ‚Äúbooster_model‚Äù items within ‚Äúiblm‚Äù class object. predict method contains option trim. truncates values booster model predictions prevent extreme deviation foundation GLM. explored Correction Corridor. IBLM essentially collection GLMs, corrected beta coefficients derived explain_iblm() function, also possible predict linear calculation.","code":"predictions <- predict(iblm_model, df_list$test) coeff_multiplier <-    df_list$test |>   select(-all_of(\"ClaimNb\")) |>   mutate(     across(       all_of(iblm_model$predictor_vars$categorical),       ~1       )     ) |>   mutate(bias = 1, .before = 1)  predictions_alt <-    (ex$data_beta_coeff * coeff_multiplier) |>   rowSums() |>    exp() |>   unname()  # difference in predictions very small between two alternative methods range(predictions_alt / predictions - 1) #> [1] -9.531663e-07  9.788184e-07"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"pinball-score","dir":"Articles","previous_headings":"Predict","what":"Pinball Score","title":"IBLM","text":"pinball score way measure performance models. shows increase (decrease negative) predictability compared using training data mean instead. example , see iblm increased score compared glm. also added xgb_model (derived section Train) comparison.","code":"get_pinball_scores(   data = df_list$test,    iblm_model = iblm_model,   additional_models = list(xgb = xgb_model)   ) |>    gt() |>    fmt_percent(\"pinball_score\")"},{"path":"https://ifoa-adswp.github.io/IBLM/articles/IBLM.html","id":"correction-corridor","dir":"Articles","previous_headings":"Predict","what":"Correction Corridor","title":"IBLM","text":"described Predict possible trim contribution booster component iblm object predicting. prevents estimates deviating far GLM foundational model. correction corridor function applies predict.iblm() different settings trim, plots results. also possible set color variable observe patterns. Note trim value zero, IBLM predictions GLM predictions.","code":"correction_corridor(   iblm_model,    df_list$test,   trim_vals = c(0.5, 0),   sample_perc = 0.1,   color = \"DrivAge\")"},{"path":"https://ifoa-adswp.github.io/IBLM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Karol Gawlowski. Author, maintainer, copyright holder. Paul Beard. Author.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gawlowski K, Beard P (2025). IBLM: Interpretable Boosted Linear Models. R package version 1.0.1, https://ifoa-adswp.github.io/IBLM/.","code":"@Manual{,   title = {IBLM: Interpretable Boosted Linear Models},   author = {Karol Gawlowski and Paul Beard},   year = {2025},   note = {R package version 1.0.1},   url = {https://ifoa-adswp.github.io/IBLM/}, }"},{"path":[]},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/index.html","id":"overview","dir":"","previous_headings":"Interpretable Boosted Linear Models","what":"Overview","title":"Interpretable Boosted Linear Models","text":"IBLM implements Interpretable Boosted Linear Models ‚Äî hybrid modelling approach combines transparency generalized linear models (GLMs) predictive power gradient boosting. package provides: Functions fitting interpretable boosted linear models Tools analyze visualize model results Support model comparison diagnostics","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/index.html","id":"installation","dir":"","previous_headings":"Interpretable Boosted Linear Models","what":"Installation","title":"Interpretable Boosted Linear Models","text":"can install released version IBLM CRAN: can install development version GitHub:","code":"install.packages(\"IBLM\") # install.packages(\"remotes\") remotes::install_github(\"IFoA-ADSWP/IBLM\")"},{"path":"https://ifoa-adswp.github.io/IBLM/index.html","id":"example","dir":"","previous_headings":"Interpretable Boosted Linear Models","what":"Example","title":"Interpretable Boosted Linear Models","text":"‚Äôs minimal example train explain IBLM:","code":"library(IBLM)  df_list <- freMTPLmini  |>   split_into_train_validate_test()  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  ex <- explain_iblm(iblm_model, df_list$test)"},{"path":"https://ifoa-adswp.github.io/IBLM/index.html","id":"documentation","dir":"","previous_headings":"Interpretable Boosted Linear Models","what":"Documentation","title":"Interpretable Boosted Linear Models","text":"Documentation various functions package visit: üîó https://ifoa-adswp.github.io/IBLM/","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/index.html","id":"contributing","dir":"","previous_headings":"Interpretable Boosted Linear Models","what":"Contributing","title":"Interpretable Boosted Linear Models","text":"Contributions welcome! ‚Äôd like report bug suggest feature, please open issue GitHub: üîó https://github.com/IFoA-ADSWP/IBLM/issues","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/index.html","id":"citation","dir":"","previous_headings":"Interpretable Boosted Linear Models","what":"Citation","title":"Interpretable Boosted Linear Models","text":"use IBLM research teaching, please cite : Gawlowski, K. Beard, P. (2025). IBLM: Interpretable Boosted Linear Models. R package version 1.0.1.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/index.html","id":"license","dir":"","previous_headings":"Interpretable Boosted Linear Models","what":"License","title":"Interpretable Boosted Linear Models","text":"package licensed MIT License. See LICENSE file full details.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Density Plot of Beta Corrections for a Variable ‚Äî beta_corrected_density","title":"Density Plot of Beta Corrections for a Variable ‚Äî beta_corrected_density","text":"Generates density plot showing distribution corrected Beta values GLM coefficient, along original Beta coefficient, standard error bounds around . NOTE function signature documents interface functions created create_beta_corrected_density.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density Plot of Beta Corrections for a Variable ‚Äî beta_corrected_density","text":"","code":"beta_corrected_density(varname, q = 0.05, type = \"kde\")"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density Plot of Beta Corrections for a Variable ‚Äî beta_corrected_density","text":"varname Character string specifying variable name coefficient name accepted well. q Number, must 0 0.5. Determines quantile range plot (.e. value 0.05 show shaps within 5pct ‚Äì> 95pct quantile range plot) type Character string, must \"kde\" \"hist\"","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density Plot of Beta Corrections for a Variable ‚Äî beta_corrected_density","text":"ggplot object(s) showing density distribution corrected beta coefficients vertical lines indicating original coefficient value standard error bounds. item returned : single ggplot object `varname` numerical variable coefficient name list ggplot objects `varname` categorical variable","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_density.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Density Plot of Beta Corrections for a Variable ‚Äî beta_corrected_density","text":"plot shows: Density curve corrected coefficient values Solid vertical line original GLM coefficient Dashed lines plus/minus 1 standard error coefficient Automatic x-axis limits cut highest lowest q pct. want axis unaltered, set q = 0","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Density Plot of Beta Corrections for a Variable ‚Äî beta_corrected_density","text":"","code":"# This function is created inside explain_iblm() and is output as an item  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  explain_objects <- explain_iblm(iblm_model, df_list$test)  # plot can be for a single categorical level OR a categorical variable explain_objects$beta_corrected_density(varname = \"AreaB\")   # output can be numerical variable explain_objects$beta_corrected_density(varname = \"DrivAge\")    # This function must be created, and cannot be called directly from the package try( beta_corrected_density(varname = \"DrivAge\") ) #> Error in beta_corrected_density(varname = \"DrivAge\") :  #>   This function documents the interface only and cannot be called #> directly. Instead, try one of the following #> ‚Ñπ Use explain_iblm()$beta_corrected_density() #> ‚Ñπ Call a function output from create_beta_corrected_density()"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Scatter Plot of Beta Corrections for a Variable ‚Äî beta_corrected_scatter","title":"Scatter Plot of Beta Corrections for a Variable ‚Äî beta_corrected_scatter","text":"Generates scatter plot boxplot showing SHAP corrections specified variable fitted model. numerical variables, creates scatter plot optional coloring marginal densities. categorical variables, creates boxplot model coefficients overlaid. NOTE function signature documents interface functions created create_beta_corrected_scatter.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scatter Plot of Beta Corrections for a Variable ‚Äî beta_corrected_scatter","text":"","code":"beta_corrected_scatter(varname, q = 0, color = NULL, marginal = FALSE)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scatter Plot of Beta Corrections for a Variable ‚Äî beta_corrected_scatter","text":"varname Character. Name variable plot SHAP corrections . Must present fitted model. q Numeric. Quantile threshold outlier removal. 0 (default) function remove outliers color Character NULL. Name variable use point coloring. Must present model. Currently supported categorical variables. marginal Logical. Whether add marginal density plots (numerical variables ).","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_scatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scatter Plot of Beta Corrections for a Variable ‚Äî beta_corrected_scatter","text":"ggplot2 object. numerical variables: scatter plot SHAP corrections,   model coefficient line, confidence bands. categorical variables: boxplot   coefficient points overlaid.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_scatter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Scatter Plot of Beta Corrections for a Variable ‚Äî beta_corrected_scatter","text":"function handles numerical categorical variables differently: Numerical: Creates scatter plot variable values vs. beta + SHAP deviations Categorical: Creates boxplot SHAP deviations level coefficient overlay numerical variables, horizontal lines show model coefficient (solid) confidence intervals (dashed). SHAP corrections represent local deviations global model coefficient.","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrected_scatter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scatter Plot of Beta Corrections for a Variable ‚Äî beta_corrected_scatter","text":"","code":"# This function is created inside explain_iblm() and is output as an item  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  explain_objects <- explain_iblm(iblm_model, df_list$test)  # plot can be for a categorical variable (box plot) explain_objects$beta_corrected_scatter(varname = \"Area\")   # plot can be for a numerical variable (scatter plot) explain_objects$beta_corrected_scatter(varname = \"DrivAge\") #> `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'    # This function must be created, and cannot be called directly from the package try( beta_corrected_scatter(varname = \"DrivAge\") ) #> Error in beta_corrected_scatter(varname = \"DrivAge\") :  #>   This function documents the interface only and cannot be called #> directly. Instead, try one of the following #> ‚Ñπ Use explain_iblm()$beta_corrected_scatter() #> ‚Ñπ Call a function output from create_beta_corrected_scatter()"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrections_derive.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Beta Corrections based on SHAP values ‚Äî beta_corrections_derive","title":"Compute Beta Corrections based on SHAP values ‚Äî beta_corrections_derive","text":"Processes SHAP values one-hot (wide) format create beta coefficient corrections. includes: scaling shap values continuous variables predictor value row migrating shap values bias continuous variables predictor value zero migrating shap values bias categorical variables predictor value reference level","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrections_derive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Beta Corrections based on SHAP values ‚Äî beta_corrections_derive","text":"","code":"beta_corrections_derive(   shap_wide,   wide_input_frame,   iblm_model,   migrate_reference_to_bias = TRUE )"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrections_derive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Beta Corrections based on SHAP values ‚Äî beta_corrections_derive","text":"shap_wide Data frame containing SHAP values XGBoost converted wide format [shap_to_onehot()] wide_input_frame Wide format input data frame (one-hot encoded). iblm_model Object class 'iblm' migrate_reference_to_bias Logical, migrate beta corrections bias reference levels? applied categorical vars . recommended leave setting TRUE","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrections_derive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Beta Corrections based on SHAP values ‚Äî beta_corrections_derive","text":"data frame booster model beta corrections one-hot (wide) format","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/beta_corrections_derive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Beta Corrections based on SHAP values ‚Äî beta_corrections_derive","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  shap <- extract_booster_shap(iblm_model$booster_model, df_list$test)  wide_input_frame <- data_to_onehot(df_list$test, iblm_model)  shap_wide <- shap_to_onehot(shap, wide_input_frame, iblm_model)  beta_corrections <- beta_corrections_derive(shap_wide, wide_input_frame, iblm_model)  beta_corrections |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 24 #> $ bias          <dbl> -0.037607307, -0.093988436, -0.016267627, -0.039208010, ‚Ä¶ #> $ VehPower      <dbl> -8.648532e-04, -3.418528e-03, 2.084949e-03, 1.190031e-03‚Ä¶ #> $ VehAge        <dbl> -1.181081e-01, -1.903213e-01, 7.902823e-03, 6.329534e-03‚Ä¶ #> $ DrivAge       <dbl> -1.840783e-04, 7.133882e-04, -4.240216e-04, 1.399568e-03‚Ä¶ #> $ BonusMalus    <dbl> -1.981097e-04, 3.789446e-04, -5.019076e-04, 1.458261e-04‚Ä¶ #> $ AreaA         <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ AreaB         <dbl> 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.000000‚Ä¶ #> $ AreaC         <dbl> 0.000000000, 0.000000000, 0.000000000, -0.009702625, -0.‚Ä¶ #> $ AreaD         <dbl> 0.000000000, 0.000000000, 0.003410609, 0.000000000, 0.00‚Ä¶ #> $ AreaE         <dbl> -0.017667860, 0.000000000, 0.000000000, 0.000000000, 0.0‚Ä¶ #> $ AreaF         <dbl> 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0‚Ä¶ #> $ VehBrandB1    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB10   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB11   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB12   <dbl> -0.06775799, 0.00000000, 0.00000000, 0.00000000, 0.00000‚Ä¶ #> $ VehBrandB13   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB14   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB2    <dbl> 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ‚Ä¶ #> $ VehBrandB3    <dbl> 0.0000000, 0.0000000, -0.0293063, 0.0000000, 0.0000000, ‚Ä¶ #> $ VehBrandB4    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB5    <dbl> 0.00000000, 0.00000000, 0.00000000, 0.04647116, 0.000000‚Ä¶ #> $ VehBrandB6    <dbl> 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.00‚Ä¶ #> $ VehGasDiesel  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehGasRegular <dbl> 0.000000000, 0.000000000, 0.000000000, -0.006539818, 0.0‚Ä¶"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/bias_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Density Plot of Bias Corrections from SHAP values ‚Äî bias_density","title":"Density Plot of Bias Corrections from SHAP values ‚Äî bias_density","text":"Visualizes distribution SHAP corrections migrated bias terms, showing per-variable total bias corrections. NOTE function signature documents interface functions created create_bias_density.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/bias_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density Plot of Bias Corrections from SHAP values ‚Äî bias_density","text":"","code":"bias_density(q = 0, type = \"hist\")"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/bias_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density Plot of Bias Corrections from SHAP values ‚Äî bias_density","text":"q Numeric value 0 0.5 quantile bounds. higher number trim edges (useful outliers distorting plot window) Default 0 (.e. trimming) type Character string specifying plot type: \"kde\" kernel density \"hist\" histogram. Default \"hist\".","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/bias_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density Plot of Bias Corrections from SHAP values ‚Äî bias_density","text":"list two ggplot objects: bias_correction_var: Faceted plot showing bias correction density variable.     Note variables records contributing bias correction dropped plot. bias_correction_total: Plot showing total corrected bias density.","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/bias_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Density Plot of Bias Corrections from SHAP values ‚Äî bias_density","text":"","code":"# This function is created inside explain_iblm() and is output as an item  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  explain_objects <- explain_iblm(iblm_model, df_list$test)  explain_objects$bias_density() #> $bias_correction_var  #>  #> $bias_correction_total  #>    # This function must be created, and cannot be called directly from the package try( bias_density() ) #> Error in bias_density() :  #>   This function documents the interface only and cannot be called #> directly. Instead, try one of the following #> ‚Ñπ Use explain_iblm()$bias_density() #> ‚Ñπ Call a function output from create_bias_density()"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_data_variability.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Data Variability for Modeling ‚Äî check_data_variability","title":"Check Data Variability for Modeling ‚Äî check_data_variability","text":"Validates response variable predictor variables one unique value.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_data_variability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Data Variability for Modeling ‚Äî check_data_variability","text":"","code":"check_data_variability(data, response_var)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_data_variability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Data Variability for Modeling ‚Äî check_data_variability","text":"data data frame containing variables check. response_var Character string naming response variable `data`.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_data_variability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Data Variability for Modeling ‚Äî check_data_variability","text":"Invisibly returns `TRUE` checks pass, otherwise throws error.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_iblm_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Object of Class `iblm` ‚Äî check_iblm_model","title":"Check Object of Class `iblm` ‚Äî check_iblm_model","text":"Validates iblm model object required structure features","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_iblm_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Object of Class `iblm` ‚Äî check_iblm_model","text":"","code":"check_iblm_model(model, booster_models_supported = c(\"xgb.Booster\"))"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_iblm_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Object of Class `iblm` ‚Äî check_iblm_model","text":"model Model object validate, expected class \"iblm\" booster_models_supported Booster model classes currently supported iblm package","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_iblm_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Object of Class `iblm` ‚Äî check_iblm_model","text":"Invisible TRUE checks pass","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/check_iblm_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Object of Class `iblm` ‚Äî check_iblm_model","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  check_iblm_model(iblm_model)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/correction_corridor.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GLM vs IBLM Predictions with Different Corridors ‚Äî correction_corridor","title":"Plot GLM vs IBLM Predictions with Different Corridors ‚Äî correction_corridor","text":"Creates faceted scatter plot comparing GLM predictions ensemble predictions across different trim values, showing ensemble corrects base GLM model.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/correction_corridor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GLM vs IBLM Predictions with Different Corridors ‚Äî correction_corridor","text":"","code":"correction_corridor(   iblm_model,   data,   trim_vals = c(NA_real_, 4, 1, 0.2, 0.1, 0),   sample_perc = 0.2,   color = NA,   ... )"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/correction_corridor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GLM vs IBLM Predictions with Different Corridors ‚Äî correction_corridor","text":"iblm_model IBLM model object class \"iblm\". data Data frame. used `split_into_train_validate_test()` usually \"test\" portion data. trim_vals Numeric vector trim values compare. length vector dictate . facets shown plot output sample_perc Proportion data randomly sample plotting (0 1). Default 0.2 improve performance large datasets color Optional. Name variable `data` color points ... Additional arguments passed `geom_point()`","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/correction_corridor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot GLM vs IBLM Predictions with Different Corridors ‚Äî correction_corridor","text":"ggplot object showing GLM vs IBLM predictions faceted trim value.   diagonal line (y = x) represents perfect agreement models","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/correction_corridor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot GLM vs IBLM Predictions with Different Corridors ‚Äî correction_corridor","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  correction_corridor(iblm_model = iblm_model, data = df_list$test, color = \"DrivAge\")"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Pre-Configured Beta Corrected Density Plot Function ‚Äî create_beta_corrected_density","title":"Create Pre-Configured Beta Corrected Density Plot Function ‚Äî create_beta_corrected_density","text":"Factory function returns plotting function data pre-configured.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Pre-Configured Beta Corrected Density Plot Function ‚Äî create_beta_corrected_density","text":"","code":"create_beta_corrected_density(   wide_input_frame,   beta_corrections,   data,   iblm_model )"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Pre-Configured Beta Corrected Density Plot Function ‚Äî create_beta_corrected_density","text":"wide_input_frame Dataframe. Wide format input data (one-hot encoded). beta_corrections Dataframe. Output beta_corrections_derive. data Dataframe. testing data. iblm_model Object class 'iblm'.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Pre-Configured Beta Corrected Density Plot Function ‚Äî create_beta_corrected_density","text":"Function signature function(varname, q = 0.05, type = \"kde\").","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Pre-Configured Beta Corrected Density Plot Function ‚Äî create_beta_corrected_density","text":"","code":"# ------- prepare iblm objects required -------  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  test_data <- df_list$test shap <- extract_booster_shap(iblm_model$booster_model, test_data) wide_input_frame <- data_to_onehot(test_data, iblm_model) shap_wide <- shap_to_onehot(shap, wide_input_frame, iblm_model) beta_corrections <- beta_corrections_derive(shap_wide, wide_input_frame, iblm_model)  # ------- demonstration of functionality -------  # create_beta_corrected_density() can create function of type 'beta_corrected_density' my_beta_corrected_density <- create_beta_corrected_density(   wide_input_frame,   beta_corrections,   test_data,   iblm_model )  # this custom function then acts as per beta_corrected_density() my_beta_corrected_density(varname = \"VehAge\")"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Pre-Configured Beta Corrected Scatter Plot Function ‚Äî create_beta_corrected_scatter","title":"Create Pre-Configured Beta Corrected Scatter Plot Function ‚Äî create_beta_corrected_scatter","text":"Factory function returns plotting function data pre-configured.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Pre-Configured Beta Corrected Scatter Plot Function ‚Äî create_beta_corrected_scatter","text":"","code":"create_beta_corrected_scatter(data_beta_coeff, data, iblm_model)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Pre-Configured Beta Corrected Scatter Plot Function ‚Äî create_beta_corrected_scatter","text":"data_beta_coeff Dataframe. Contains corrected beta coefficients row data. data Dataframe. testing data. iblm_model Object class 'iblm'.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_scatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Pre-Configured Beta Corrected Scatter Plot Function ‚Äî create_beta_corrected_scatter","text":"Function signature function(varname, q = 0, color = NULL, marginal = FALSE).","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_beta_corrected_scatter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Pre-Configured Beta Corrected Scatter Plot Function ‚Äî create_beta_corrected_scatter","text":"","code":"# ------- prepare iblm objects required -------  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  test_data <- df_list$test shap <- extract_booster_shap(iblm_model$booster_model, test_data) wide_input_frame <- data_to_onehot(test_data, iblm_model) shap_wide <- shap_to_onehot(shap, wide_input_frame, iblm_model) beta_corrections <- beta_corrections_derive(shap_wide, wide_input_frame, iblm_model) data_glm <- data_beta_coeff_glm(test_data, iblm_model) data_booster <- data_beta_coeff_booster(test_data, beta_corrections, iblm_model) data_beta_coeff <- data_glm + data_booster  # ------- demonstration of functionality -------  # create_beta_corrected_scatter() can create function of type 'beta_corrected_scatter' my_beta_corrected_scatter <- create_beta_corrected_scatter(data_beta_coeff, test_data, iblm_model)  # this custom function then acts as per beta_corrected_scatter() my_beta_corrected_scatter(varname = \"VehAge\") #> `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_bias_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Pre-Configured Bias Density Plot Function ‚Äî create_bias_density","title":"Create Pre-Configured Bias Density Plot Function ‚Äî create_bias_density","text":"Factory function returns plotting function data pre-configured.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_bias_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Pre-Configured Bias Density Plot Function ‚Äî create_bias_density","text":"","code":"create_bias_density(shap, data, iblm_model, migrate_reference_to_bias = TRUE)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_bias_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Pre-Configured Bias Density Plot Function ‚Äî create_bias_density","text":"shap Dataframe. Contains raw SHAP values. data Dataframe. testing data. iblm_model Object class 'iblm'. migrate_reference_to_bias TRUE/FALSE determines whether shap values categorical reference levels migrated bias? Default TRUE","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_bias_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Pre-Configured Bias Density Plot Function ‚Äî create_bias_density","text":"Function signature function(q = 0, type = \"hist\").","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_bias_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Pre-Configured Bias Density Plot Function ‚Äî create_bias_density","text":"","code":"# ------- prepare iblm objects required -------  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  test_data <- df_list$test shap <- extract_booster_shap(iblm_model$booster_model, test_data)  # ------- demonstration of functionality -------  # create_bias_density() can create function of type 'bias_density' my_bias_density <- create_bias_density(shap, test_data, iblm_model)  # this custom function then acts as per bias_density() my_bias_density() #> $bias_correction_var  #>  #> $bias_correction_total  #>"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_overall_correction.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Pre-Configured Overall Correction Plot Function ‚Äî create_overall_correction","title":"Create Pre-Configured Overall Correction Plot Function ‚Äî create_overall_correction","text":"Factory function returns plotting function data pre-configured.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_overall_correction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Pre-Configured Overall Correction Plot Function ‚Äî create_overall_correction","text":"","code":"create_overall_correction(shap, iblm_model)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_overall_correction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Pre-Configured Overall Correction Plot Function ‚Äî create_overall_correction","text":"shap Dataframe. Contains raw SHAP values. iblm_model Object class 'iblm'.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_overall_correction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Pre-Configured Overall Correction Plot Function ‚Äî create_overall_correction","text":"Function signature function(transform_x_scale_by_link = TRUE).","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/create_overall_correction.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Pre-Configured Overall Correction Plot Function ‚Äî create_overall_correction","text":"","code":"# ------- prepare iblm objects required -------  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  test_data <- df_list$test shap <- extract_booster_shap(iblm_model$booster_model, test_data)  # ------- demonstration of functionality -------  # create_overall_correction() can create function of type 'overall_correction' my_overall_correction <- create_overall_correction(shap, iblm_model)  # this custom function then acts as per overall_correction() my_overall_correction()"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_booster.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain Booster Model Beta Corrections for tabular data ‚Äî data_beta_coeff_booster","title":"Obtain Booster Model Beta Corrections for tabular data ‚Äî data_beta_coeff_booster","text":"Creates dataframe Shap beta corrections row predictor variable `data`","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_booster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain Booster Model Beta Corrections for tabular data ‚Äî data_beta_coeff_booster","text":"","code":"data_beta_coeff_booster(data, beta_corrections, iblm_model)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_booster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain Booster Model Beta Corrections for tabular data ‚Äî data_beta_coeff_booster","text":"data data frame containing dataset analysis beta_corrections data frame matrix containing beta correction values variables bias iblm_model Object class 'iblm'","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_booster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain Booster Model Beta Corrections for tabular data ‚Äî data_beta_coeff_booster","text":"data frame beta coefficient corrections. structure dimension `data` except \"bias\" column start.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_booster.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Obtain Booster Model Beta Corrections for tabular data ‚Äî data_beta_coeff_booster","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  explainer_outputs <- explain_iblm(iblm_model, df_list$test)  data_booster <- data_beta_coeff_booster(   df_list$test,   explainer_outputs$beta_corrections,   iblm_model )  data_booster |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 8 #> $ bias       <dbl> -0.037607307, -0.093988436, -0.016267627, -0.039208010, -0.‚Ä¶ #> $ Area       <dbl> -0.017667860, 0.000000000, 0.003410609, -0.009702625, -0.02‚Ä¶ #> $ VehPower   <dbl> -8.648532e-04, -3.418528e-03, 2.084949e-03, 1.190031e-03, -‚Ä¶ #> $ VehAge     <dbl> -1.181081e-01, -1.903213e-01, 7.902823e-03, 6.329534e-03, 4‚Ä¶ #> $ DrivAge    <dbl> -1.840783e-04, 7.133882e-04, -4.240216e-04, 1.399568e-03, -‚Ä¶ #> $ BonusMalus <dbl> -1.981097e-04, 3.789446e-04, -5.019076e-04, 1.458261e-04, -‚Ä¶ #> $ VehBrand   <dbl> -6.775799e-02, 0.000000e+00, -2.930630e-02, 4.647116e-02, 6‚Ä¶ #> $ VehGas     <dbl> 0.000000000, 0.000000000, 0.000000000, -0.006539818, 0.0000‚Ä¶"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain GLM Beta Coefficients for tabular data ‚Äî data_beta_coeff_glm","title":"Obtain GLM Beta Coefficients for tabular data ‚Äî data_beta_coeff_glm","text":"Creates dataframe GLM beta coefficients row predictor variable `data`","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain GLM Beta Coefficients for tabular data ‚Äî data_beta_coeff_glm","text":"","code":"data_beta_coeff_glm(data, iblm_model)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain GLM Beta Coefficients for tabular data ‚Äî data_beta_coeff_glm","text":"data Data frame predictor variables iblm_model Object class 'iblm'","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain GLM Beta Coefficients for tabular data ‚Äî data_beta_coeff_glm","text":"data frame beta coefficients. structure dimension `data` except \"bias\" column start.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_beta_coeff_glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Obtain GLM Beta Coefficients for tabular data ‚Äî data_beta_coeff_glm","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  data_glm <- data_beta_coeff_glm(df_list$train, iblm_model)  data_glm |> dplyr::glimpse() #> Rows: 17,423 #> Columns: 8 #> $ bias       <dbl> -2.365821, -2.365821, -2.365821, -2.365821, -2.365821, -2.3‚Ä¶ #> $ Area       <dbl> -0.004269464, -0.004269464, -0.137876072, 0.000000000, 0.28‚Ä¶ #> $ VehPower   <dbl> -0.005447975, -0.005447975, -0.005447975, -0.005447975, -0.‚Ä¶ #> $ VehAge     <dbl> -0.04132123, -0.04132123, -0.04132123, -0.04132123, -0.0413‚Ä¶ #> $ DrivAge    <dbl> -0.003435393, -0.003435393, -0.003435393, -0.003435393, -0.‚Ä¶ #> $ BonusMalus <dbl> 0.01192857, 0.01192857, 0.01192857, 0.01192857, 0.01192857,‚Ä¶ #> $ VehBrand   <dbl> 0.01820581, 0.00000000, 0.02804685, 0.02804685, 0.72133504,‚Ä¶ #> $ VehGas     <dbl> 0.2654272, 0.2654272, 0.2654272, 0.0000000, 0.2654272, 0.00‚Ä¶"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_to_onehot.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Data Frame to Wide One-Hot Encoded Format ‚Äî data_to_onehot","title":"Convert Data Frame to Wide One-Hot Encoded Format ‚Äî data_to_onehot","text":"Transforms categorical variables data frame one-hot encoded format","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_to_onehot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Data Frame to Wide One-Hot Encoded Format ‚Äî data_to_onehot","text":"","code":"data_to_onehot(data, iblm_model, remove_target = TRUE)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_to_onehot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Data Frame to Wide One-Hot Encoded Format ‚Äî data_to_onehot","text":"data Input data frame transformed. typically \"train\" data subset iblm_model Object class 'iblm' remove_target Logical, whether remove response_var variable output (default TRUE).","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_to_onehot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Data Frame to Wide One-Hot Encoded Format ‚Äî data_to_onehot","text":"data frame wide format one-hot encoded categorical variables, intercept column, variables ordered according \"coeff_names$\" `iblm_model`","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/data_to_onehot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Data Frame to Wide One-Hot Encoded Format ‚Äî data_to_onehot","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  wide_input_frame <- data_to_onehot(df_list$test, iblm_model)  wide_input_frame |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 24 #> $ `(Intercept)` <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,‚Ä¶ #> $ VehPower      <int> 11, 5, 6, 5, 7, 4, 6, 5, 7, 4, 7, 6, 5, 11, 7, 4, 7, 6, ‚Ä¶ #> $ VehAge        <dbl> 1, 1, 8, 14, 12, 15, 12, 1, 1, 1, 0, 0, 1, 2, 4, 2, 0, 3‚Ä¶ #> $ DrivAge       <int> 58, 25, 42, 72, 47, 19, 45, 34, 37, 36, 41, 49, 55, 65, ‚Ä¶ #> $ BonusMalus    <int> 50, 95, 50, 50, 50, 100, 90, 76, 50, 50, 50, 50, 50, 50,‚Ä¶ #> $ AreaA         <int> 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ AreaB         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0,‚Ä¶ #> $ AreaC         <int> 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1,‚Ä¶ #> $ AreaD         <int> 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0,‚Ä¶ #> $ AreaE         <int> 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0,‚Ä¶ #> $ AreaF         <int> 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB1    <int> 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB10   <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB11   <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB12   <int> 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1,‚Ä¶ #> $ VehBrandB13   <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB14   <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB2    <int> 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0,‚Ä¶ #> $ VehBrandB3    <int> 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB4    <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB5    <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB6    <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehGasDiesel  <int> 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1,‚Ä¶ #> $ VehGasRegular <int> 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0,‚Ä¶"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/explain_iblm.html","id":null,"dir":"Reference","previous_headings":"","what":"Explain GLM Model Predictions Using SHAP Values ‚Äî explain_iblm","title":"Explain GLM Model Predictions Using SHAP Values ‚Äî explain_iblm","text":"Creates list explains beta values, corrections, ensemble IBLM model","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/explain_iblm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Explain GLM Model Predictions Using SHAP Values ‚Äî explain_iblm","text":"","code":"explain_iblm(iblm_model, data, migrate_reference_to_bias = TRUE)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/explain_iblm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Explain GLM Model Predictions Using SHAP Values ‚Äî explain_iblm","text":"iblm_model object class 'iblm'. output `train_iblm_xgb()` data Data frame. used `split_into_train_validate_test()` \"test\" portion data. migrate_reference_to_bias Logical, migrate beta corrections bias reference levels? applied categorical vars . recommended leave setting TRUE","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/explain_iblm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Explain GLM Model Predictions Using SHAP Values ‚Äî explain_iblm","text":"list containing: beta_corrected_scatter Function create scatter plots showing SHAP corrections vs variable values (see beta_corrected_scatter) beta_corrected_density Function create density plots SHAP corrections variables (see beta_corrected_density) bias_density Function create density plots SHAP corrections migrated bias (see bias_density) overall_correction Function show global correction distributions (see overall_correction) shap Dataframe showing raw SHAP values data records beta_corrections Dataframe showing beta corrections (wide/one-hot format) data records data_beta_coeff Dataframe showing beta coefficients data records","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/explain_iblm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Explain GLM Model Predictions Using SHAP Values ‚Äî explain_iblm","text":"following outputs functions can called create plots: beta_corrected_scatter beta_corrected_density bias_density overall_correction , key data arguments (e.g. data, shap, iblm_model) already populated `explain_iblm()`. calling functions output `explain_iblm()` key settings like variable names, colours...etc need populating.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/explain_iblm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Explain GLM Model Predictions Using SHAP Values ‚Äî explain_iblm","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  ex <- explain_iblm(iblm_model, df_list$test)  # the output contains functions that can be called to visualise iblm ex$beta_corrected_scatter(\"DrivAge\") #> `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'  ex$beta_corrected_density(\"DrivAge\")  ex$overall_correction()  ex$bias_density() #> $bias_correction_var  #>  #> $bias_correction_total  #>   # the output contains also dataframes ex$shap |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 8 #> $ Area       <dbl> -0.017667860, 0.016070237, 0.003410609, -0.009702625, -0.02‚Ä¶ #> $ VehPower   <dbl> -9.513386e-03, -1.709264e-02, 1.250970e-02, 5.950155e-03, -‚Ä¶ #> $ VehAge     <dbl> -0.1181081235, -0.1903213263, 0.0632225871, 0.0886134803, 0‚Ä¶ #> $ DrivAge    <dbl> -0.0106765414, 0.0178347062, -0.0178089067, 0.1007688642, -‚Ä¶ #> $ BonusMalus <dbl> -0.009905483, 0.035999734, -0.025095381, 0.007291305, -0.03‚Ä¶ #> $ VehBrand   <dbl> -6.775799e-02, -7.489327e-02, -2.930630e-02, 4.647116e-02, ‚Ä¶ #> $ VehGas     <dbl> 0.0016007025, 0.0040426101, 0.0229403824, -0.0065398184, 0.‚Ä¶ #> $ BIAS       <dbl> -0.03920801, -0.03920801, -0.03920801, -0.03920801, -0.0392‚Ä¶ ex$beta_corrections |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 24 #> $ bias          <dbl> -0.037607307, -0.093988436, -0.016267627, -0.039208010, ‚Ä¶ #> $ VehPower      <dbl> -8.648532e-04, -3.418528e-03, 2.084949e-03, 1.190031e-03‚Ä¶ #> $ VehAge        <dbl> -1.181081e-01, -1.903213e-01, 7.902823e-03, 6.329534e-03‚Ä¶ #> $ DrivAge       <dbl> -1.840783e-04, 7.133882e-04, -4.240216e-04, 1.399568e-03‚Ä¶ #> $ BonusMalus    <dbl> -1.981097e-04, 3.789446e-04, -5.019076e-04, 1.458261e-04‚Ä¶ #> $ AreaA         <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ AreaB         <dbl> 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.000000‚Ä¶ #> $ AreaC         <dbl> 0.000000000, 0.000000000, 0.000000000, -0.009702625, -0.‚Ä¶ #> $ AreaD         <dbl> 0.000000000, 0.000000000, 0.003410609, 0.000000000, 0.00‚Ä¶ #> $ AreaE         <dbl> -0.017667860, 0.000000000, 0.000000000, 0.000000000, 0.0‚Ä¶ #> $ AreaF         <dbl> 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0‚Ä¶ #> $ VehBrandB1    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB10   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB11   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB12   <dbl> -0.06775799, 0.00000000, 0.00000000, 0.00000000, 0.00000‚Ä¶ #> $ VehBrandB13   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB14   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB2    <dbl> 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ‚Ä¶ #> $ VehBrandB3    <dbl> 0.0000000, 0.0000000, -0.0293063, 0.0000000, 0.0000000, ‚Ä¶ #> $ VehBrandB4    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB5    <dbl> 0.00000000, 0.00000000, 0.00000000, 0.04647116, 0.000000‚Ä¶ #> $ VehBrandB6    <dbl> 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.00‚Ä¶ #> $ VehGasDiesel  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehGasRegular <dbl> 0.000000000, 0.000000000, 0.000000000, -0.006539818, 0.0‚Ä¶ ex$data_beta_coeff |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 8 #> $ bias       <dbl> -2.403428, -2.459809, -2.382088, -2.405029, -2.381321, -2.4‚Ä¶ #> $ Area       <dbl> -0.021937324, 0.000000000, 0.069380839, -0.147578696, -0.16‚Ä¶ #> $ VehPower   <dbl> -0.006312828, -0.008866502, -0.003363025, -0.004257944, -0.‚Ä¶ #> $ VehAge     <dbl> -0.15942935, -0.23164256, -0.03341841, -0.03499170, -0.0368‚Ä¶ #> $ DrivAge    <dbl> -0.003619471, -0.002722004, -0.003859414, -0.002035825, -0.‚Ä¶ #> $ BonusMalus <dbl> 0.01173046, 0.01230752, 0.01142666, 0.01207440, 0.01129568,‚Ä¶ #> $ VehBrand   <dbl> 0.647894859, 0.000000000, -0.001259444, 0.767806208, 0.0182‚Ä¶ #> $ VehGas     <dbl> 0.0000000, 0.0000000, 0.0000000, 0.2588874, 0.0000000, 0.25‚Ä¶"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/extract_booster_shap.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","title":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","text":"function extract SHAP (SHapley Additive exPlanations) values fitted booster model","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/extract_booster_shap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","text":"","code":"extract_booster_shap(booster_model, data, ...)  # S3 method for class 'xgb.Booster' extract_booster_shap(booster_model, data, ...)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/extract_booster_shap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","text":"booster_model model object. IBLM context \"booster_model\" item object class \"iblm\" data data frame containing predictor variables. Note anything extra quietly dropped. ... Additional arguments passed methods.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/extract_booster_shap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","text":"data frame SHAP values, column corresponds feature   row corresponds observation.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/extract_booster_shap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","text":"Currently booster_model class `xgb.Booster` supported","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/extract_booster_shap.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","text":"extract_booster_shap(xgb.Booster): Extract SHAP values `xgb.Booster` model","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/extract_booster_shap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract SHAP values from an xgboost Booster model ‚Äî extract_booster_shap","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  booster_shap <- extract_booster_shap(iblm_model$booster_model, df_list$test)  booster_shap |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 8 #> $ Area       <dbl> -0.017667860, 0.016070237, 0.003410609, -0.009702625, -0.02‚Ä¶ #> $ VehPower   <dbl> -9.513386e-03, -1.709264e-02, 1.250970e-02, 5.950155e-03, -‚Ä¶ #> $ VehAge     <dbl> -0.1181081235, -0.1903213263, 0.0632225871, 0.0886134803, 0‚Ä¶ #> $ DrivAge    <dbl> -0.0106765414, 0.0178347062, -0.0178089067, 0.1007688642, -‚Ä¶ #> $ BonusMalus <dbl> -0.009905483, 0.035999734, -0.025095381, 0.007291305, -0.03‚Ä¶ #> $ VehBrand   <dbl> -6.775799e-02, -7.489327e-02, -2.930630e-02, 4.647116e-02, ‚Ä¶ #> $ VehGas     <dbl> 0.0016007025, 0.0040426101, 0.0229403824, -0.0065398184, 0.‚Ä¶ #> $ BIAS       <dbl> -0.03920801, -0.03920801, -0.03920801, -0.03920801, -0.0392‚Ä¶"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/freMTPLmini.html","id":null,"dir":"Reference","previous_headings":"","what":"French Motor Insurance Claims Dataset ‚Äî freMTPLmini","title":"French Motor Insurance Claims Dataset ‚Äî freMTPLmini","text":"dataset containing information French motor insurance policies claims, commonly used actuarial modeling risk assessment studies. \"mini\" subset CASdatasets `freMTPL2freq` data, manipulation (see details)","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/freMTPLmini.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"French Motor Insurance Claims Dataset ‚Äî freMTPLmini","text":"","code":"freMTPLmini"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/freMTPLmini.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"French Motor Insurance Claims Dataset ‚Äî freMTPLmini","text":"data frame 25,000 rows 8 variables: ClaimRate Number claims made, annualised rate, rounded (integer) VehPower Vehicle power rating engine horsepower category (integer) VehAge Age vehicle years (integer) DrivAge Age driver years (integer) BonusMalus Bonus-malus coefficient, rating factor used French     insurance lower values indicate better driving records (integer) VehBrand Vehicle brand/manufacturer code (factor levels like B6, B12, etc.) VehGas Type fuel used vehicle (factor levels: Regular, Diesel) Area Area classification policy holder resides     (factor levels F)","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/freMTPLmini.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"French Motor Insurance Claims Dataset ‚Äî freMTPLmini","text":"['https://github.com/dutangc/CASdatasets/raw/c49cbbb37235fc49616cac8ccac32e1491cdc619/data/freMTPL2freq.rda']","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/freMTPLmini.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"French Motor Insurance Claims Dataset ‚Äî freMTPLmini","text":"dataset random sample 50,000 records `freMTPL2freq` `CASdatasets` pacakge. modifications applied : ClaimRate: Converted ClaimNb per Exposure, winsorized 99.9th percentile, rounded. VehAge: Ceiling 50 years applied Dropped columns: Region, Density, Exposure, ClaimNb, IDpol","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/freMTPLmini.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"French Motor Insurance Claims Dataset ‚Äî freMTPLmini","text":"","code":"head(freMTPLmini) #> # A tibble: 6 √ó 8 #>   Area  VehPower VehAge DrivAge BonusMalus VehBrand VehGas  ClaimRate #>   <fct>    <int>  <dbl>   <int>      <int> <fct>    <fct>       <int> #> 1 E           10     14      60         50 B2       Regular         0 #> 2 E            6      4      50         53 B1       Regular         0 #> 3 C            7      2      37         50 B3       Regular         0 #> 4 E           11      1      58         50 B12      Diesel          0 #> 5 B            8      1      29         64 B12      Regular         0 #> 6 A            7      1      28         57 B3       Diesel          0"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/get_pinball_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Pinball Scores for IBLM and Additional Models ‚Äî get_pinball_scores","title":"Calculate Pinball Scores for IBLM and Additional Models ‚Äî get_pinball_scores","text":"Computes Poisson deviance pinball scores IBLM model alongside homogeneous, GLM, optional additional models.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/get_pinball_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Pinball Scores for IBLM and Additional Models ‚Äî get_pinball_scores","text":"","code":"get_pinball_scores(   data,   iblm_model,   trim = NA_real_,   additional_models = list() )"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/get_pinball_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Pinball Scores for IBLM and Additional Models ‚Äî get_pinball_scores","text":"data Data frame. used `split_into_train_validate_test()` \"test\" portion data. iblm_model Fitted IBLM model object class \"iblm\" trim Numeric trimming parameter IBLM predictions. Default `NA_real_`. additional_models (Named) list fitted models comparison. models MUST fitted data `iblm_model` sensible results. unnamed, models labeled class.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/get_pinball_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Pinball Scores for IBLM and Additional Models ‚Äî get_pinball_scores","text":"Data frame 3 columns: \"model\" - homog, glm, iblm models specified `additional_models` \"`family`_deviance\" - value loss function based family glm function \"pinball_score\" - positive score, better model basic homog model (.e. predictions mean value). negative score indicates worse homog model.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/get_pinball_scores.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Pinball Scores for IBLM and Additional Models ‚Äî get_pinball_scores","text":"Pinball scores calculated relative homogeneous model (.e. simple mean prediction training data). Higher scores indicate better predictive performance.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/get_pinball_scores.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Pinball Scores for IBLM and Additional Models ‚Äî get_pinball_scores","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  get_pinball_scores(data = df_list$test, iblm_model = iblm_model) #>   model poisson_deviance pinball_score #> 1 homog         1.313877    0.00000000 #> 2   glm         1.232683    0.06179691 #> 3  iblm         1.201009    0.08590424"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/load_freMTPL2freq.html","id":null,"dir":"Reference","previous_headings":"","what":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","title":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","text":"Downloads French Motor Third-Party Liability (freMTPL2freq) dataset CASdatasets GitHub repository, apply minor transformations.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/load_freMTPL2freq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","text":"","code":"load_freMTPL2freq()"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/load_freMTPL2freq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","text":"data frame containing following columns: ClaimNb Number claims per year. VehPower power car (ordered categorical). VehAge vehicle age years, capped 50. DrivAge driver age years (minimum 18, legal driving age       France). BonusMalus Bonus/malus coefficient, ranging 50 350. Values       100 indicate bonus (discount), values 100 indicate       malus (surcharge) French insurance system. VehBrand car brand (categorical, unknown/proprietary       category labels). VehGas car fuel type: \"Diesel\" \"Regular\". Area density classification city community       driver lives, ranging \"\" (rural area) \"F\" (urban centre). Density population density (inhabitants per square kilometer)       city driver lives. Region policy region France, based 1970-2015       administrative classification.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/load_freMTPL2freq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","text":"function performs following modifications sourced: ClaimNb: Converted ClaimNb per Exposure, winsorized 99.9th percentile VehAge: Ceiling 50 years applied character variables converted factor type","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/load_freMTPL2freq.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","text":"function requires internet connection download data.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/load_freMTPL2freq.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","text":"Dutang, C. CASdatasets: Insurance datasets. https://github.com/dutangc/CASdatasets/raw/c49cbbb37235fc49616cac8ccac32e1491cdc619/data/freMTPL2freq.rda","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/load_freMTPL2freq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load French Motor Third-Party Liability Frequency Dataset ‚Äî load_freMTPL2freq","text":"","code":"# \\donttest{ # Load the preprocessed dataset freMTPL2freq <- load_freMTPL2freq()  freMTPL2freq |> dplyr::glimpse() #> Rows: 678,013 #> Columns: 10 #> $ ClaimNb    <dbl> 10.000000, 1.298701, 1.333333, 11.111111, 1.190476, 1.92307‚Ä¶ #> $ Area       <fct> D, D, B, B, B, E, E, C, C, B, B, C, D, D, E, F, A, A, A, A,‚Ä¶ #> $ VehPower   <int> 5, 5, 6, 7, 7, 6, 6, 7, 7, 7, 7, 7, 4, 4, 4, 9, 6, 6, 6, 6,‚Ä¶ #> $ VehAge     <dbl> 0, 0, 2, 0, 0, 2, 2, 0, 0, 0, 0, 0, 1, 0, 9, 0, 2, 2, 2, 2,‚Ä¶ #> $ DrivAge    <int> 55, 55, 52, 46, 46, 38, 38, 33, 33, 41, 41, 56, 27, 27, 23,‚Ä¶ #> $ BonusMalus <int> 50, 50, 50, 50, 50, 50, 50, 68, 68, 50, 50, 50, 90, 90, 100‚Ä¶ #> $ VehBrand   <fct> B12, B12, B12, B12, B12, B12, B12, B12, B12, B12, B12, B12,‚Ä¶ #> $ VehGas     <fct> Regular, Regular, Diesel, Diesel, Diesel, Regular, Regular,‚Ä¶ #> $ Density    <int> 1217, 1217, 54, 76, 76, 3003, 3003, 137, 137, 60, 60, 173, ‚Ä¶ #> $ Region     <fct> R82, R82, R22, R72, R72, R31, R31, R91, R91, R52, R52, R93,‚Ä¶ # }"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/overall_correction.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Overall Corrections from Booster Component ‚Äî overall_correction","title":"Plot Overall Corrections from Booster Component ‚Äî overall_correction","text":"Creates visualization showing record overall booster component (either multiplicative additive) NOTE function signature documents interface functions created create_overall_correction.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/overall_correction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Overall Corrections from Booster Component ‚Äî overall_correction","text":"","code":"overall_correction(transform_x_scale_by_link = TRUE)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/overall_correction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Overall Corrections from Booster Component ‚Äî overall_correction","text":"transform_x_scale_by_link TRUE/FALSE, whether transform x axis link function","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/overall_correction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Overall Corrections from Booster Component ‚Äî overall_correction","text":"ggplot2 object.","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/overall_correction.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Overall Corrections from Booster Component ‚Äî overall_correction","text":"","code":"# This function is created inside explain_iblm() and is output as an item  df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  explain_objects <- explain_iblm(iblm_model, df_list$test)  explain_objects$overall_correction()    # This function must be created, and cannot be called directly from the package try( overall_correction() ) #> Error in overall_correction() :  #>   This function documents the interface only and cannot be called #> directly. Instead, try one of the following #> ‚Ñπ Use explain_iblm()$overall_correction() #> ‚Ñπ Call a function output from create_overall_correction()"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/predict.iblm.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict Method for IBLM ‚Äî predict.iblm","title":"Predict Method for IBLM ‚Äî predict.iblm","text":"function generates predictions ensemble model consisting GLM XGBoost model.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/predict.iblm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict Method for IBLM ‚Äî predict.iblm","text":"","code":"# S3 method for class 'iblm' predict(object, newdata, trim = NA_real_, type = \"response\", ...)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/predict.iblm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict Method for IBLM ‚Äî predict.iblm","text":"object object class 'iblm'. output `train_iblm_xgb()` newdata data frame matrix containing predictor variables predictions desired. Must structure training data used fit 'iblm' model. trim Numeric value post-hoc truncating XGBoost predictions. NA (default) trimming applied. type string, defines type argument used GLM/Booster Currently \"response\" supported ... additional arguments affecting predictions produced.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/predict.iblm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict Method for IBLM ‚Äî predict.iblm","text":"numeric vector ensemble predictions computed element-wise   product GLM response probabilities (optionally trimmed) XGBoost   predictions.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/predict.iblm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict Method for IBLM ‚Äî predict.iblm","text":"prediction process involves following steps: Generate GLM predictions Generate Booster predictions trimming specified, apply booster predictions Combine GLM Booster predictions per \"relationship\" described within iblm model object point, iblm model \"booster_model\" object class `xgb.Booster` supported","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/predict.iblm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict Method for IBLM ‚Äî predict.iblm","text":"","code":"data <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   data,   response_var = \"ClaimRate\",   family = \"poisson\" )  predictions <- predict(iblm_model, data$test)  predictions |> dplyr::glimpse() #>  num [1:3764] 0.196 0.195 0.112 0.206 0.071 ..."},{"path":"https://ifoa-adswp.github.io/IBLM/reference/shap_to_onehot.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Shap values to Wide One-Hot Encoded Format ‚Äî shap_to_onehot","title":"Convert Shap values to Wide One-Hot Encoded Format ‚Äî shap_to_onehot","text":"Transforms categorical variables data frame one-hot encoded format. Renames \"BIAS\" lowercase.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/shap_to_onehot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Shap values to Wide One-Hot Encoded Format ‚Äî shap_to_onehot","text":"","code":"shap_to_onehot(shap, wide_input_frame, iblm_model)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/shap_to_onehot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Shap values to Wide One-Hot Encoded Format ‚Äî shap_to_onehot","text":"shap Data frame containing raw SHAP values XGBoost. wide_input_frame Wide format input data frame (one-hot encoded). iblm_model Object class 'iblm'","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/shap_to_onehot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Shap values to Wide One-Hot Encoded Format ‚Äî shap_to_onehot","text":"data frame SHAP values wide format categorical variables. Column \"bias\" moved start.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/shap_to_onehot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Shap values to Wide One-Hot Encoded Format ‚Äî shap_to_onehot","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )  shap <- extract_booster_shap(iblm_model$booster_model, df_list$test)  wide_input_frame <- data_to_onehot(df_list$test, iblm_model)  shap_wide <- shap_to_onehot(shap, wide_input_frame, iblm_model)  shap_wide |> dplyr::glimpse() #> Rows: 3,764 #> Columns: 24 #> $ bias          <dbl> -0.03920801, -0.03920801, -0.03920801, -0.03920801, -0.0‚Ä¶ #> $ VehPower      <dbl> -9.513386e-03, -1.709264e-02, 1.250970e-02, 5.950155e-03‚Ä¶ #> $ VehAge        <dbl> -0.1181081235, -0.1903213263, 0.0632225871, 0.0886134803‚Ä¶ #> $ DrivAge       <dbl> -0.0106765414, 0.0178347062, -0.0178089067, 0.1007688642‚Ä¶ #> $ BonusMalus    <dbl> -0.009905483, 0.035999734, -0.025095381, 0.007291305, -0‚Ä¶ #> $ AreaA         <dbl> 0.000000000, 0.016070237, 0.000000000, 0.000000000, 0.00‚Ä¶ #> $ AreaB         <dbl> 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.000000‚Ä¶ #> $ AreaC         <dbl> 0.000000000, 0.000000000, 0.000000000, -0.009702625, -0.‚Ä¶ #> $ AreaD         <dbl> 0.000000000, 0.000000000, 0.003410609, 0.000000000, 0.00‚Ä¶ #> $ AreaE         <dbl> -0.017667860, 0.000000000, 0.000000000, 0.000000000, 0.0‚Ä¶ #> $ AreaF         <dbl> 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0‚Ä¶ #> $ VehBrandB1    <dbl> 0.000000000, -0.074893273, 0.000000000, 0.000000000, 0.0‚Ä¶ #> $ VehBrandB10   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB11   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB12   <dbl> -0.06775799, 0.00000000, 0.00000000, 0.00000000, 0.00000‚Ä¶ #> $ VehBrandB13   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB14   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB2    <dbl> 0.000000e+00, 0.000000e+00, 0.000000e+00, 0.000000e+00, ‚Ä¶ #> $ VehBrandB3    <dbl> 0.0000000, 0.0000000, -0.0293063, 0.0000000, 0.0000000, ‚Ä¶ #> $ VehBrandB4    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,‚Ä¶ #> $ VehBrandB5    <dbl> 0.00000000, 0.00000000, 0.00000000, 0.04647116, 0.000000‚Ä¶ #> $ VehBrandB6    <dbl> 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.00‚Ä¶ #> $ VehGasDiesel  <dbl> 0.0016007025, 0.0040426101, 0.0229403824, 0.0000000000, ‚Ä¶ #> $ VehGasRegular <dbl> 0.000000000, 0.000000000, 0.000000000, -0.006539818, 0.0‚Ä¶"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/split_into_train_validate_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Split Dataframe into: 'train', 'validate', 'test' ‚Äî split_into_train_validate_test","title":"Split Dataframe into: 'train', 'validate', 'test' ‚Äî split_into_train_validate_test","text":"function randomly splits data frame three subsets machine learning workflows: training, validation, test sets. proportions can customized must sum 1.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/split_into_train_validate_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split Dataframe into: 'train', 'validate', 'test' ‚Äî split_into_train_validate_test","text":"","code":"split_into_train_validate_test(   df,   train_prop = 0.7,   validate_prop = 0.15,   test_prop = 0.15,   seed = NULL )"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/split_into_train_validate_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split Dataframe into: 'train', 'validate', 'test' ‚Äî split_into_train_validate_test","text":"df data frame split subsets. train_prop numeric value 0 1 specifying proportion data allocate training set. validate_prop numeric value 0 1 specifying proportion data allocate validation set. test_prop numeric value 0 1 specifying proportion data allocate test set. seed (optional) numeric value set random . seed within function environment.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/split_into_train_validate_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split Dataframe into: 'train', 'validate', 'test' ‚Äî split_into_train_validate_test","text":"named list three elements: train data frame containing training subset validate data frame containing validation subset test data frame containing test subset","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/split_into_train_validate_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Split Dataframe into: 'train', 'validate', 'test' ‚Äî split_into_train_validate_test","text":"function assigns row either \"train\", \"validate\" \"test\" probability defined function. row assigned bucket independently, small datasets proportions may desired. issue data used `iblm` must reasonably large.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/split_into_train_validate_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Split Dataframe into: 'train', 'validate', 'test' ‚Äî split_into_train_validate_test","text":"","code":"# Using 'mtcars' split_into_train_validate_test(   mtcars,   train_prop = 0.6,   validate_prop = 0.2,   test_prop = 0.2,   seed = 9000 ) #> $train #>                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb #> Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4 #> Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1 #> Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4 #> Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2 #> Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4 #> Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3 #> Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3 #> Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 #> Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4 #> Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1 #> Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1 #> Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2 #> AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2 #> Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4 #> Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2 #> Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1 #> Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4 #> Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6 #> Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8 #>  #> $validate #>                    mpg cyl  disp  hp drat    wt  qsec vs am gear carb #> Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2 #> Lotus Europa      30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2 #> Volvo 142E        21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2 #>  #> $test #>                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb #> Mazda RX4          21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4 #> Datsun 710         22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1 #> Hornet 4 Drive     21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1 #> Merc 240D          24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2 #> Merc 280C          17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4 #> Merc 450SLC        15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3 #> Cadillac Fleetwood 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4 #> Honda Civic        30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2 #> Toyota Corolla     33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1 #> Porsche 914-2      26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2 #>"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/theme_iblm.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom ggplot2 Theme for IBLM ‚Äî theme_iblm","title":"Custom ggplot2 Theme for IBLM ‚Äî theme_iblm","text":"Custom ggplot2 Theme IBLM","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/theme_iblm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom ggplot2 Theme for IBLM ‚Äî theme_iblm","text":"","code":"theme_iblm()"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/theme_iblm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Custom ggplot2 Theme for IBLM ‚Äî theme_iblm","text":"ggplot2 theme object can added plots.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_iblm_xgb.html","id":null,"dir":"Reference","previous_headings":"","what":"Train IBLM Model on XGBoost ‚Äî train_iblm_xgb","title":"Train IBLM Model on XGBoost ‚Äî train_iblm_xgb","text":"function trains interpretable boosted linear model. function combines Generalized Linear Model (GLM) booster model XGBoost \"booster\" model trained : - actual responses / GLM predictions, link function log - actual responses - GLM predictions, link function identity","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_iblm_xgb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Train IBLM Model on XGBoost ‚Äî train_iblm_xgb","text":"","code":"train_iblm_xgb(   df_list,   response_var,   family = \"poisson\",   params = list(),   nrounds = 1000,   objective = NULL,   custom_metric = NULL,   verbose = 0,   print_every_n = 1L,   early_stopping_rounds = 25,   maximize = NULL,   save_period = NULL,   save_name = \"xgboost.model\",   xgb_model = NULL,   callbacks = list(),   ...,   strip_glm = TRUE )"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_iblm_xgb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Train IBLM Model on XGBoost ‚Äî train_iblm_xgb","text":"df_list named list containing training validation datasets. Must elements named \"train\" \"validate\", containing df_list frames structure. item naturally output function [split_into_train_validate_test()] response_var Character string specifying name response variable column datasets. string MUST appear `df_list$train` `df_list$validate`. family Character string specifying distributional family model. Currently \"poisson\", \"gamma\", \"tweedie\" \"gaussian\" fully supported. See details impacts fitting. params Named list additional parameters pass xgb.train. Note train_iblm_xgb select \"objective\" \"base_score\" depending `family` (see details section). However may overwrite (caution) nrounds, objective, custom_metric, verbose, print_every_n, early_stopping_rounds, maximize, save_period, save_name, xgb_model, callbacks, ... passed directly xgb.train strip_glm TRUE/FALSE, whether strip superfluous data `glm_model` object saved within `iblm` class output. serves reduce memory constraints.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_iblm_xgb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Train IBLM Model on XGBoost ‚Äî train_iblm_xgb","text":"object class \"iblm\" containing: glm_model GLM model object, fitted `df_list$train` data provided booster_model booster model object, trained residuals leftover glm_model data list containing data used train validate iblm model relationship String explains combine `glm_model` `booster_model`. Currently either \"Additive\" \"Multiplicative\" response_var string describing response variable used iblm model predictor_vars list describing predictor variables used iblm model cat_levels list describing categorical levels predictor vars coeff_names list describing coefficient names","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_iblm_xgb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Train IBLM Model on XGBoost ‚Äî train_iblm_xgb","text":"`family` argument fed GLM fitting. Default `params` values XGBoost fitting also selected based family: \"poisson\" family, \"objective\" set \"count:poisson\" \"gamma\" family, \"objective\" set \"reg:gamma\" \"tweedie\" family, \"objective\" set \"reg:tweedie\". Also, \"tweedie_variance_power = 1.5\". \"gaussian\" family, \"objective\" set \"reg:squarederror\" Note: xgboost configuration overwritten explicit arguments input `train_iblm_xgb()`","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_iblm_xgb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Train IBLM Model on XGBoost ‚Äî train_iblm_xgb","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  iblm_model <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\" )"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_xgb_as_per_iblm.html","id":null,"dir":"Reference","previous_headings":"","what":"Train XGBoost Model Using the IBLM Model Parameters ‚Äî train_xgb_as_per_iblm","title":"Train XGBoost Model Using the IBLM Model Parameters ‚Äî train_xgb_as_per_iblm","text":"Trains XGBoost model using parameters extracted booster residual component iblm model. convenient way fit XGBoost model direct comparison fitted iblm model","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_xgb_as_per_iblm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Train XGBoost Model Using the IBLM Model Parameters ‚Äî train_xgb_as_per_iblm","text":"","code":"train_xgb_as_per_iblm(iblm_model, ...)"},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_xgb_as_per_iblm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Train XGBoost Model Using the IBLM Model Parameters ‚Äî train_xgb_as_per_iblm","text":"iblm_model Ensemble model object class \"iblm\" containing GLM XGBoost model components. Also contains data used train . ... optional arguments insert xgb.train(). Note cause deviation settings used training `iblm_model`","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_xgb_as_per_iblm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Train XGBoost Model Using the IBLM Model Parameters ‚Äî train_xgb_as_per_iblm","text":"Trained XGBoost model object (class \"xgb.Booster\").","code":""},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/reference/train_xgb_as_per_iblm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Train XGBoost Model Using the IBLM Model Parameters ‚Äî train_xgb_as_per_iblm","text":"","code":"df_list <- freMTPLmini |> split_into_train_validate_test(seed = 9000)  # training with plenty of rounds allowed iblm_model1 <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\",   params = list(max_depth = 6),   nrounds = 1000 )  xgb1 <- train_xgb_as_per_iblm(iblm_model1)  # training with severe restrictions (expected poorer results) iblm_model2 <- train_iblm_xgb(   df_list,   response_var = \"ClaimRate\",   family = \"poisson\",   params = list(max_depth = 1),   nrounds = 5 )  xgb2 <- train_xgb_as_per_iblm(iblm_model2)  # comparison shows the poor training mirrored in second set: get_pinball_scores(   df_list$test,   iblm_model1,   trim = NA_real_,   additional_models = list(iblm2 = iblm_model2, xgb1 = xgb1, xgb2 = xgb2) ) #>   model poisson_deviance pinball_score #> 1 homog         1.313877    0.00000000 #> 2   glm         1.232683    0.06179691 #> 3  iblm         1.201009    0.08590424 #> 4 iblm2         1.211335    0.07804541 #> 5  xgb1         1.212865    0.07688069 #> 6  xgb2         1.259753    0.04119366"},{"path":[]},{"path":"https://ifoa-adswp.github.io/IBLM/news/index.html","id":"major-changes-1-0-2","dir":"Changelog","previous_headings":"","what":"Major changes","title":"IBLM 1.0.2","text":"iblm class model objects now require factor variables categorical features. Users explicitly convert character columns factors training.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/news/index.html","id":"new-features-1-0-2","dir":"Changelog","previous_headings":"","what":"New features","title":"IBLM 1.0.2","text":"Added ‚ÄúIBLM‚Äù vignette providing comprehensive walkthrough package functionality.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/news/index.html","id":"bug-fixes-1-0-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"IBLM 1.0.2","text":"Fixed bug variable types converted numeric training predicting booster model, lead improper handling categorical features.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/news/index.html","id":"internal-changes-1-0-2","dir":"Changelog","previous_headings":"","what":"Internal changes","title":"IBLM 1.0.2","text":"Updated maintain compatibility xgboost v3.1.2.1. Package now requires xgboost >= 3.1.2.1.","code":""},{"path":"https://ifoa-adswp.github.io/IBLM/news/index.html","id":"iblm-100","dir":"Changelog","previous_headings":"","what":"IBLM 1.0.0","title":"IBLM 1.0.0","text":"Initial CRAN submission.","code":""}]
